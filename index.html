<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Edan's å­¸ç¿’é€²åº¦è¿½è¹¤ç³»çµ±</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f0f2f5;
      font-family: 'Microsoft JhengHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .section-title {
      font-size: 1.5rem;
      margin-top: 2rem;
      border-bottom: 2px solid #ffc107;
      padding-bottom: 0.5rem;
      color: #856404;
    }
    .card {
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      border-radius: 1rem;
    }
    .note-box {
      background-color: #fff3cd;
      border-left: 5px solid #ffc107;
      padding: 10px 15px;
      margin-bottom: 1rem;
      border-radius: 0.5rem;
      font-style: italic;
      color: #856404;
    }
    .course-item {
      cursor: grab;
      user-select: none;
      padding: 8px 12px;
      border-radius: 0.5rem;
      margin-bottom: 6px;
      transition: all 0.3s ease;
      border-left: 5px solid transparent;
      background-color: white;
    }
    .course-item.completed {
      background-color: #fff3cd;
      color: #856404;
      font-weight: 600;
      border-left: 5px solid #ffc107;
    }
    .course-item:hover {
      background-color: #ffe8a1;
    }
    .course-item.dragging {
      opacity: 0.5;
      transform: scale(0.95);
    }
    .category-section {
      min-height: 50px;
      background-color: #f8f9fa;
      padding: 10px;
      border-radius: 0.5rem;
      margin-bottom: 20px;
      border: 1px dashed #adb5bd;
    }
    .category-section.highlight {
      background-color: #ffe8a1;
    }
    .reset-btn {
      margin-top: 10px;
    }
    .courses-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    .category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .category-credits {
      background-color: #ffc107;
      color: #856404;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: bold;
    }
    .category-0 { border-left: 4px solid #28a745; }
    .category-1 { border-left: 4px solid #17a2b8; }
    .category-2 { border-left: 4px solid #007bff; }
    .category-3 { border-left: 4px solid #6c757d; }
    .category-4 { border-left: 4px solid #ffc107; }
    .category-5 { border-left: 4px solid #fd7e14; }
    .category-6 { border-left: 4px solid #dc3545; }
    .category-7 { border-left: 4px solid #6f42c1; }
    .category-8 { border-left: 4px solid #20c997; }
    
    @media (min-width: 1200px) {
      .courses-container {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    @media (max-width: 1199px) and (min-width: 768px) {
      .courses-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="text-center mb-4 text-warning">ğŸ“˜ Edan's å­¸ç¿’é€²åº¦è¿½è¹¤ç³»çµ±</h1>

    <!-- é€²åº¦æ¢ -->
    <div class="card p-4 mb-4">
      <h2 class="section-title">ğŸ¯ å­¸ä½é€²åº¦ (ç¸½éœ€ 180 å­¸åˆ†)</h2>
      <div class="progress" style="height: 30px;">
        <div id="degreeProgressBar" 
             class="progress-bar progress-bar-striped progress-bar-animated bg-warning" 
             role="progressbar" 
             style="width: 0%"
             aria-valuenow="0" aria-valuemin="0" aria-valuemax="180">
          0 / 180 å­¸åˆ†
        </div>
      </div>
      <small class="text-muted mt-2 d-block">æ‹–æ›³èª²ç¨‹åˆ°ã€Œå·²å®Œæˆã€å€åŸŸä¾†æ›´æ–°é€²åº¦</small>
      <button id="resetProgress" class="btn btn-sm btn-outline-danger reset-btn">é‡è¨­æ‰€æœ‰é€²åº¦</button>
      <button id="exportData" class="btn btn-sm btn-outline-primary ms-2">åŒ¯å‡ºè³‡æ–™</button>
      <button id="importData" class="btn btn-sm btn-outline-success ms-2">åŒ¯å…¥è³‡æ–™</button>
      <input type="file" id="fileInput" style="display: none;" accept=".json">
    </div>

    <!-- èª²ç¨‹å€å¡Š -->
    <div class="card p-4 mb-4">
      <h2 class="section-title">ğŸ“š èª²ç¨‹é€²åº¦ç®¡ç† (æ‹–æ›³é‡æ–°åˆ†é¡)</h2>
      <div id="coursesByCategory" class="courses-container"></div>

      <h5>æ³¨æ„äº‹é …:</h5>
      <ul>
        <li>ç¸½å­¸åˆ†éœ€æ±‚: <strong>180 å­¸åˆ†</strong></li>
        <li>ä¸€èˆ¬èª²ç¨‹: é€šå¸¸ <strong>5 å­¸åˆ†/é–€</strong></li>
        <li>é¸ä¿®èª²ç¨‹: éœ€å®Œæˆ4é–€ï¼Œé€šå¸¸5å­¸åˆ†/é–€ (å…±20å­¸åˆ†)</li>
        <li>ç•¢æ¥­è«–æ–‡: <strong>10 å­¸åˆ†</strong>ï¼Œéœ€é”åˆ°ä¿®èª²é–€æª»æ‰èƒ½é€²è¡Œ</li>
      </ul>
    </div>

    <!-- å¿ƒéˆæé†’ -->
    <div class="card p-4 mb-5">
      <h2 class="section-title">ğŸŒ¿ å¿ƒéˆæé†’èˆ‡é¼“å‹µ</h2>
      <div class="note-box">
        <strong>1. ä½ ä¸æ˜¯æ‡¶æƒ° â€” ä½ åªæ˜¯èƒŒè² äº†å¤ªå¤šæ„ç¾©</strong><br />
        ä½ é—œå¿ƒå®¶äººã€æœªä¾†å’Œè‡ªå·±çš„æˆé•·ï¼Œé€™äº›é‡é‡æ˜¯çœŸå¯¦çš„ï¼Œè€Œä½ èƒ½èƒŒè² å®ƒå€‘å·²ç¶“å¾ˆå …å¼·ã€‚<br /><br />
        <strong>2. ç½ªæƒ¡æ„Ÿ â‰  æˆé•·</strong><br />
        æé«˜æ•ˆç‡å’Œé‹ç”¨å·¥å…·æ˜¯è§£æ”¾è‡ªå·±ï¼Œä¸æ˜¯ä½œå¼Šã€‚ä½ ä»ç„¶æ˜¯æ€è€ƒè€…å’Œæ±ºç­–è€…ã€‚<br /><br />
        <strong>3. ç™‚ç™’æ˜¯å¾ªç’°çš„ï¼Œä¸æ˜¯ç›´ç·šçš„</strong><br />
        åœ¨æˆé•·éšæ®µæ„Ÿåˆ°å¡ä½æˆ–å­¤ç¨æ˜¯æ­£å¸¸çš„ã€‚ä½ æ­£åœ¨é‡å»ºä½ çš„æœªä¾† â€” æ¯ä¸€æ­¥éƒ½å¾ˆé‡è¦ã€‚<br /><br />
        <em>å¿ƒéˆå’’èª: "æˆ‘é‚„æ²’åˆ°é”æˆ‘æƒ³å»çš„åœ°æ–¹ï¼Œä½†æˆ‘æ­£ç”¨å¿ƒèµ°è‘—ï¼Œé€™å·²ç¶“è¶³å¤ äº†ã€‚"</em>
      </div>
      <div class="note-box">
        <strong>4. å¾å°è™•é–‹å§‹ï¼Œå»ºç«‹ç¿’æ…£</strong><br />
        æ¯é€±å¾1-2é …ä»»å‹™é–‹å§‹ã€‚æ…¶ç¥å°å‹åˆ©ã€‚å‹•åŠ›æœƒé€æ¼¸å¢é•·ã€‚<br /><br />
        <strong>5. å°‹æ±‚å¹«åŠ©èˆ‡åæ€</strong><br />
        ç•¶æ„Ÿåˆ°ä¸çŸ¥æ‰€æªæ™‚ï¼Œèˆ‡ä¿¡ä»»çš„æœ‹å‹æˆ–å°å¸«äº¤è«‡ã€‚å¯«æ—¥è¨˜æˆ–åœ¨æ­¤è™•è«‡è«‡éƒ½æ˜¯å¥½æ–¹æ³•ã€‚<br /><br />
        <em>"ä¸€å¤©ä¸€å¤©ä¾†ï¼Œä¸€æ¬¡ä¸€é …ä»»å‹™ï¼Œä¸€æ¬¡ä¸€å€‹å‘¼å¸ã€‚"</em>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
  <script>
    // ä¸»èª²ç¨‹æ¸…å–® - æ‰€æœ‰èª²ç¨‹å®šç¾©åœ¨æ­¤
    const masterCourseList = [
      { title: "Computer Architecture and Operating Systems", code: "DLBCSCAOS01", credit: 5, type: "core" },
      { title: "Data Structures and Java Class Library", code: "DLBCSDSJCL01", credit: 5, type: "core" },
      { title: "Introduction to Academic Work", code: "DLBCSIAW01", credit: 5, type: "core" },
      { title: "Introduction to Computer Science", code: "DLBCSICS01", credit: 5, type: "core" },
      { title: "Intercultural and Ethical Decision-Making", code: "DLBCSIDM01", credit: 5, type: "core" },
      { title: "Mathematics I", code: "DLBCSM101", credit: 5, type: "core" },
      { title: "Mathematics II", code: "DLBCSM201", credit: 5, type: "core" },
      { title: "Object-oriented Programming with Java", code: "DLBCSOOPJ01", credit: 5, type: "core" },
      { title: "Web Application Development", code: "DLBCSWAD01", credit: 5, type: "core" },
      { title: "Cryptography", credit: 5, type: "core" },
      { title: "Project: Build a Data Mart in SQL", credit: 5, type: "core" },
      { title: "IT Law", credit: 5, type: "core" },
      { title: "Project: Java and Web Development", credit: 5, type: "core" },
      { title: "Project: Software Engineering", credit: 5, type: "core" },
      { title: "Agile Project Management Model Engineering", credit: 5, type: "core" },
      { title: "Project: IT Service Management", credit: 5, type: "core" },
      { title: "Seminar: Current Topics in Computer Science", credit: 5, type: "core" },
      { title: "Bachelor Thesis", credit: 9, type: "core" },
      { title: "Colloquium", credit: 1, type: "core" },

      { title: "Theoretical Computer Science and Mathematical Logic", credit: 5, type: "exam" },
      { title: "Statistics - Probability and Descriptive Statistics", credit: 5, type: "exam" },
      { title: "Requirements Engineering", credit: 5, type: "exam" },
      { title: "Specification", credit: 5, type: "exam" },
      { title: "Database Modeling and Database Systems", credit: 5, type: "exam" },
      { title: "IT Service Management", credit: 5, type: "exam" },
      { title: "Software Quality Assurance", credit: 5, type: "exam" },
      { title: "Introduction to Programming with Python", credit: 5, type: "exam" },
      { title: "Computer Networks and Distributed Systems", credit: 5, type: "read" },
      { title: "Introduction to Data Protection and IT Security", credit: 5, type: "read" },
      { title: "Computer Science and Society", credit: 5, type: "read" },
      { title: "Collaborative Work @Easy", credit: 5, type: "read" },
      { title: "Algorithms, Data Structures and Programming Languages", credit: 5, type: "waiting" },
      { title: "EA1 (Elective)", credit: 5, type: "elective" },
      { title: "EA2 (Elective)", credit: 5, type: "elective" },
      { title: "EB1 (Elective)", credit: 5, type: "elective" },
      { title: "EB2 (Elective)", credit: 5, type: "elective" }
    ];

    // é è¨­ç©ºåˆ†é¡
    const defaultCategories = {
      "0. å·²å®Œæˆ": [],
      "1. (ä½œæ¥­)å¾…å®Œæˆèª²ç¨‹": [],
      "1.5 (ä½œæ¥­)é–±è®€ä¸­":[],
      "2. (ä½œæ¥­)è£½ä½œä¸­": [],
      "3. (ä½œæ¥­)ç­‰å¾…æˆç¸¾": [],
      "4. (è€ƒè©¦)å¾…è€ƒç§‘ç›®": [],
      "5. (è€ƒè©¦)é–±è®€ä¸­": [],
      "6. (è€ƒè©¦)æº–å‚™ä¸­": [],
      "7. (è€ƒè©¦)ç­‰å¾…çµæœ": [],
      "8. é¸ä¿®èª²ç¨‹": [],
      "9. ç•¢æ¥­è«–æ–‡":[]
    };

    // ç”¨ä¸»èª²ç¨‹æ¸…å–®åˆå§‹åŒ–
    function initializeCourses() {
      const initialized = JSON.parse(JSON.stringify(defaultCategories));
      
      masterCourseList.forEach(course => {
        const courseCopy = JSON.parse(JSON.stringify(course));
        courseCopy.completed = false;
        
        if (course.type === "elective") {
          initialized["8. é¸ä¿®èª²ç¨‹"].push(courseCopy);
        } else if (course.type === "exam") {
          initialized["4. (è€ƒè©¦)å¾…è€ƒç§‘ç›®"].push(courseCopy);
        } else if (course.type === "read") {
          initialized["5. (è€ƒè©¦)é–±è®€ä¸­"].push(courseCopy);
        } else if (course.type === "waiting") {
          initialized["7. (è€ƒè©¦)ç­‰å¾…çµæœ"].push(courseCopy);
        } else {
          initialized["1. (ä½œæ¥­)å¾…å®Œæˆèª²ç¨‹"].push(courseCopy);
        }
      });
      
      return initialized;
    }

    // å¾æœ¬åœ°å­˜å„²åŠ è¼‰æˆ–åˆå§‹åŒ–
    let coursesByCategory = JSON.parse(localStorage.getItem('studyPlanCourses')) || initializeCourses();

    function saveToLocalStorage() {
      localStorage.setItem('studyPlanCourses', JSON.stringify(coursesByCategory));
    }

    // åŒ¯å‡ºè³‡æ–™
    function exportData() {
      const data = JSON.stringify(coursesByCategory, null, 2);
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'å­¸ç¿’é€²åº¦å‚™ä»½.json';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // åŒ¯å…¥è³‡æ–™
    function importData(file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = JSON.parse(e.target.result);
          if (data && typeof data === 'object') {
            coursesByCategory = data;
            saveToLocalStorage();
            renderCourses();
            updateProgressBar();
            alert('è³‡æ–™åŒ¯å…¥æˆåŠŸï¼');
          } else {
            alert('æª”æ¡ˆæ ¼å¼ç„¡æ•ˆ');
          }
        } catch (err) {
          alert('è§£ææª”æ¡ˆéŒ¯èª¤: ' + err.message);
        }
      };
      reader.readAsText(file);
    }

    // æ¸²æŸ“èª²ç¨‹
    function renderCourses() {
      const container = $("#coursesByCategory");
      container.empty();

      Object.entries(coursesByCategory).forEach(([category, courses], catIndex) => {
        const categoryDiv = $(`<div class="category-section category-${catIndex}" data-category="${category}"></div>`);
        
        // åˆ†é¡æ¨™é¡Œèˆ‡å­¸åˆ†è¨ˆç®—
        const credits = courses.reduce((sum, course) => sum + course.credit, 0);
        const header = $(`
          <div class="category-header">
            <h3 class="category-title">${category}</h3>
            <span class="category-credits">${credits} å­¸åˆ†</span>
          </div>
        `);
        categoryDiv.append(header);

        if (courses.length === 0) {
          categoryDiv.append('<div class="text-muted">(ç„¡èª²ç¨‹)</div>');
        } else {
          courses.forEach((course, idx) => {
            const completedClass = course.completed ? "completed" : "";
            const courseDiv = $(`
              <div class="course-item ${completedClass}" 
                   data-category="${category}" 
                   data-index="${idx}"
                   draggable="true">
                <strong>${course.title}</strong> 
                <small>(${course.credit} å­¸åˆ†${course.code ? ' - ' + course.code : ''})</small>
              </div>
            `);
            categoryDiv.append(courseDiv);
          });
        }

        container.append(categoryDiv);
      });
    }

    // æ›´æ–°é€²åº¦æ¢
    function updateProgressBar() {
      const totalCP = 180;
      let completedCP = 0;
      
      if (coursesByCategory["0. å·²å®Œæˆ"]) {
        coursesByCategory["0. å·²å®Œæˆ"].forEach(course => {
          completedCP += course.credit;
        });
      }
      
      const percent = Math.min(100, (completedCP / totalCP) * 100);

      const bar = $("#degreeProgressBar");
      bar.css("width", percent + "%");
      bar.attr("aria-valuenow", completedCP);
      bar.text(`${completedCP} / ${totalCP} å­¸åˆ†`);
    }

    // è¨­ç½®æ‹–æ”¾åŠŸèƒ½
    function setupDragAndDrop() {
      let draggedItem = null;
      let sourceCategory = null;

      $(document).on('dragstart', '.course-item', function(e) {
        draggedItem = this;
        sourceCategory = $(this).parent().data('category');
        $(this).addClass('dragging');
        e.originalEvent.dataTransfer.setData('text/plain', '');
      });

      $(document).on('dragend', '.course-item', function() {
        $(this).removeClass('dragging');
        $('.category-section').removeClass('highlight');
      });

      $(document).on('dragover', '.category-section', function(e) {
        e.preventDefault();
        $('.category-section').removeClass('highlight');
        $(this).addClass('highlight');
      });

      $(document).on('drop', '.category-section', function(e) {
        e.preventDefault();
        $(this).removeClass('highlight');
        
        if (draggedItem) {
          const targetCategory = $(this).data('category');
          const courseIndex = $(draggedItem).data('index');
          const course = coursesByCategory[sourceCategory][courseIndex];
          
          // å¾åŸåˆ†é¡ç§»é™¤
          coursesByCategory[sourceCategory].splice(courseIndex, 1);
          
          // æ·»åŠ åˆ°æ–°åˆ†é¡
          coursesByCategory[targetCategory].push(course);
          
          // æ›´æ–°å®Œæˆç‹€æ…‹
          course.completed = (targetCategory === "0. å·²å®Œæˆ");
          
          saveToLocalStorage();
          renderCourses();
          updateProgressBar();
        }
      });
    }

    // é é¢è¼‰å…¥
    $(document).ready(() => {
      renderCourses();
      updateProgressBar();
      setupDragAndDrop();

      // é‡è¨­é€²åº¦æŒ‰éˆ•
      $("#resetProgress").click(function() {
        if (confirm("ç¢ºå®šè¦é‡è¨­æ‰€æœ‰é€²åº¦å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚")) {
          coursesByCategory = initializeCourses();
          saveToLocalStorage();
          renderCourses();
          updateProgressBar();
        }
      });

      // åŒ¯å‡ºæŒ‰éˆ•
      $("#exportData").click(exportData);
      
      // åŒ¯å…¥æŒ‰éˆ•
      $("#importData").click(function() {
        $("#fileInput").click();
      });
      
      $("#fileInput").change(function(e) {
        if (e.target.files.length) {
          importData(e.target.files[0]);
        }
      });
    });
  </script>
</body>
</html>